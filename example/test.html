<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>test vue</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  </head>
  <body>
    <div id="app">
      <keep-alive>
      <component :is="layout" :page="page"></component>
      </keep-alive>
    </div>
    <script>
    const layout1 = {
      props:['nav','page'],
      template:`<div>
        <header>layout 1</header>
        <div>
          <aside>aside:{{nav}}</aside>
          <main>
            <component :is="page" />
          </main>
        </div>
        </div>`,
    }
    const layout2 = {
      props:['nav','page'],
      template:`<div>
        <header>layout 2</header>
        <div>
          <aside>aside:{{nav}}</aside>
          <main>
            <component :is="page" />
          </main>
        </div>
        </div>`,
    }
    const page1 = {
      template:`<div>page 1 </div>`,
    }
    const page2 = {
      template:`<div>page 2</div>`,
    }
    const page3= {
      template:`<div>page 3</div>`,
    }
    const LoadingComponent = {
      template: '<div>loading....</div>'
    }
    const ErrorComponent = {
      template: '<div>loading error</div>'
    }
    </script>
    <script>
      Vue.component("LoadingComponent",LoadingComponent)
      Vue.component("ErrorComponent",ErrorComponent)
      const AsyncComponent = () => ({
        // 需要加载的组件 (应该是一个 `Promise` 对象)
        component: new Promise((resolve,reject)=>{
          setTimeout(function () {
          // 向 `resolve` 回调传递组件定义
          resolve({
            template: '<div>I am AsyncComponent!</div>'
          })
        }, 1000)
        }),
        // 异步组件加载时使用的组件
        loading: LoadingComponent,
        // 加载失败时使用的组件
        error: ErrorComponent,
        // 展示加载时组件的延时时间。默认值是 200 (毫秒)
        delay: 200,
        // 如果提供了超时时间且组件加载也超时了，
        // 则使用加载失败时使用的组件。默认值是：`Infinity`
        timeout: 3000
      })
      
      Vue.component("AsyncComponent",AsyncComponent)
      Vue.component("layout1",layout1)
      Vue.component("layout2",layout2)
      Vue.component("page1",page1)
      Vue.component("page2",page2)
      Vue.component('page3', function (resolve, reject) {
        setTimeout(function () {
          // 向 `resolve` 回调传递组件定义
          resolve({
            template: '<div>I am async!</div>'
          })
        }, 1000)
      })
      const datas = {
            layout:'layout1',
            page:'AsyncComponent'
          }
      const app = new Vue({
        el:'#app',
        data(){
          return datas
        }
      })
    </script>
  </body>
</html>